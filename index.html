<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate, max-age=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="-1">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Miami Beach Resort v20</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; background: linear-gradient(135deg, #1a1f2e 0%, #0f1318 100%); min-height: 100vh; color: #fff; }
        
        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.03); } }
        @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
        .animate-fade { animation: fadeIn 0.5s ease-out; }
        .animate-slide { animation: slideIn 0.4s ease-out; }
        
        /* Top Bar - Fixed height */
        .top-bar { 
            background: linear-gradient(180deg, #141824 0%, #1a1f2e 100%); 
            border-bottom: 1px solid rgba(255,255,255,0.08); 
            position: fixed; 
            top: 0; 
            left: 0;
            right: 0;
            z-index: 300; 
            padding: 14px 20px; 
            height: 70px;
            backdrop-filter: blur(10px);
        }
        .property-name { font-size: 20px; font-weight: 700; margin-bottom: 4px; }
        .property-time { font-size: 14px; color: rgba(255,255,255,0.6); }
        .property-time .gmt-badge { 
            display: inline-block;
            background: rgba(16,185,129,0.2); 
            color: #10b981;
            padding: 2px 8px; 
            border-radius: 6px; 
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
        }
        
        /* Main content with top padding */
        .main-content { padding-top: 80px; }
        
        /* Stats Row - Bigger */
        .stats-row { 
            display: grid; 
            grid-template-columns: repeat(5, 1fr); 
            gap: 14px; 
            margin-bottom: 20px; 
            padding: 20px; 
        }
        @media (max-width: 900px) { .stats-row { grid-template-columns: repeat(3, 1fr); gap: 10px; } }
        @media (max-width: 600px) { .stats-row { grid-template-columns: repeat(2, 1fr); } }
        .stat-card { 
            background: rgba(255,255,255,0.04); 
            border: 1px solid rgba(255,255,255,0.08); 
            border-radius: 16px; 
            padding: 20px 14px; 
            text-align: center; 
            transition: all 0.3s ease; 
        }
        .stat-card:hover { transform: translateY(-3px); background: rgba(255,255,255,0.08); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .stat-num { font-size: 38px; font-weight: 800; line-height: 1; }
        .stat-label { font-size: 13px; color: rgba(255,255,255,0.5); margin-top: 8px; text-transform: uppercase; letter-spacing: 1px; font-weight: 500; }
        
        /* Tabs Row - Bigger and Centered */
        .tabs-container { 
            display: flex; 
            justify-content: center; 
            padding: 0 20px; 
            margin-bottom: 20px; 
        }
        .tabs-row { 
            display: flex; 
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px; 
        }
        .nav-btn { 
            padding: 16px 20px; 
            border-radius: 12px; 
            font-size: 15px; 
            font-weight: 600; 
            border: none; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            background: rgba(255,255,255,0.06); 
            color: rgba(255,255,255,0.7); 
            white-space: nowrap; 
        }
        .nav-btn:hover { background: rgba(255,255,255,0.12); color: #fff; transform: translateY(-2px); }
        .nav-btn.active { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; box-shadow: 0 4px 15px rgba(16,185,129,0.4); }
        .nav-btn-wrapper { position: relative; }
        .notification-badge { 
            position: absolute; top: -6px; right: -6px; 
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); 
            color: white; font-size: 11px; font-weight: 700; 
            min-width: 20px; height: 20px; border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; 
            animation: pulse 2s infinite; 
            box-shadow: 0 2px 8px rgba(239,68,68,0.5);
        }
        
        /* Date Header - Properly Separated */
        .date-header-wrapper { 
            position: sticky; 
            top: 70px; 
            z-index: 200; 
            background: linear-gradient(180deg, #1a1f2e 0%, rgba(26,31,46,0.95) 100%);
            padding: 16px 20px; 
            border-bottom: 1px solid rgba(255,255,255,0.08);
            backdrop-filter: blur(10px);
        }
        .date-header-inner { 
            display: flex; 
            gap: 10px; 
            overflow-x: auto; 
            padding-bottom: 6px;
            justify-content: center;
        }
        .date-header-inner::-webkit-scrollbar { height: 4px; }
        .date-header-inner::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 2px; }
        .date-cell { 
            min-width: 90px; 
            text-align: center; 
            padding: 14px 12px; 
            background: rgba(255,255,255,0.05); 
            border-radius: 14px; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            flex-shrink: 0;
        }
        .date-cell:hover { background: rgba(255,255,255,0.12); transform: translateY(-2px); }
        .date-cell.active { background: linear-gradient(135deg, #10b981 0%, #059669 100%); box-shadow: 0 4px 15px rgba(16,185,129,0.3); }
        .date-cell .day-name { font-size: 13px; color: rgba(255,255,255,0.6); margin-bottom: 4px; font-weight: 500; }
        .date-cell.active .day-name { color: rgba(255,255,255,0.9); }
        .date-cell .day-num { font-size: 26px; font-weight: 800; }
        
        /* Room Cards */
        .room-card { 
            background: #2563eb; 
            border-radius: 12px; 
            padding: 14px 16px; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            display: flex; 
            align-items: center; 
            gap: 14px; 
            margin-bottom: 10px; 
        }
        .room-card:hover { transform: translateX(5px); filter: brightness(1.15); }
        .room-card.available { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); }
        .room-card.checkout, .room-card.dirty { background: linear-gradient(135deg, #f97316 0%, #ea580c 100%); }
        .room-card.turnover { background: linear-gradient(135deg, #8b5cf6 50%, #2563eb 50%); }
        .room-card.checkin { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); }
        .room-card.occupied { background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); }
        .room-num { font-size: 20px; font-weight: 800; min-width: 50px; }
        .room-info { flex: 1; }
        .guest-name { font-size: 16px; font-weight: 600; }
        .room-type { font-size: 13px; opacity: 0.85; }
        
        /* Today Grid - Centered and Responsive */
        .today-grid { 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: center; 
            gap: 16px; 
            padding: 24px; 
            animation: fadeIn 0.5s ease-out; 
        }
        .today-card { 
            background: rgba(255,255,255,0.04); 
            border: 1px solid rgba(255,255,255,0.1); 
            border-radius: 18px; 
            padding: 24px; 
            width: 100%;
            max-width: 380px;
            min-width: 300px;
            flex: 1 1 340px;
            transition: all 0.3s ease; 
        }
        .today-card:hover { transform: translateY(-4px); box-shadow: 0 15px 40px rgba(0,0,0,0.35); border-color: rgba(255,255,255,0.15); }
        .today-card h3 { 
            font-size: 18px; 
            margin-bottom: 18px; 
            display: flex; 
            align-items: center; 
            gap: 12px; 
        }
        .today-card .count { 
            font-size: 14px; 
            background: rgba(255,255,255,0.12); 
            padding: 5px 14px; 
            border-radius: 20px; 
            font-weight: 600;
        }
        
        /* Search Results - Centered and Colored */
        .search-results { 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: center; 
            gap: 14px; 
            padding: 24px; 
        }
        .search-result-card { 
            border-radius: 14px; 
            padding: 20px 24px; 
            min-width: 160px; 
            text-align: center; 
            cursor: pointer; 
            transition: all 0.3s ease; 
        }
        .search-result-card:hover { transform: scale(1.08); box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .search-result-card.available { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); }
        .search-result-card.occupied { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        .search-result-card .room-number { font-size: 28px; font-weight: 800; }
        .search-result-card .room-status { font-size: 13px; opacity: 0.9; margin-top: 6px; font-weight: 500; }
        
        /* View Toggle */
        .view-toggle { 
            display: flex; 
            gap: 8px; 
            padding: 8px; 
            background: rgba(255,255,255,0.05); 
            border-radius: 12px; 
        }
        .view-toggle button { 
            padding: 12px 24px; 
            border: none; 
            border-radius: 10px; 
            background: transparent; 
            color: rgba(255,255,255,0.6); 
            cursor: pointer; 
            font-size: 15px; 
            font-weight: 600; 
            transition: all 0.3s ease; 
        }
        .view-toggle button.active { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; }
        .view-toggle button:hover:not(.active) { background: rgba(255,255,255,0.1); color: #fff; }
        
        /* Search Date Selectors */
        .date-selector { 
            padding: 20px 28px; 
            background: rgba(255,255,255,0.05); 
            border-radius: 14px; 
            cursor: pointer; 
            min-width: 180px; 
            text-align: center; 
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .date-selector:hover { background: rgba(255,255,255,0.1); }
        .date-selector.active { 
            background: rgba(16,185,129,0.15); 
            border-color: #10b981; 
        }
        .date-selector .label { font-size: 13px; opacity: 0.7; margin-bottom: 6px; }
        .date-selector .date { font-size: 22px; font-weight: 700; }
        
        /* Housekeeping Grid */
        .housekeeping-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); 
            gap: 20px; 
            padding: 24px; 
        }
        .housekeeping-column { 
            background: rgba(255,255,255,0.04); 
            border-radius: 16px; 
            padding: 20px; 
        }
        .housekeeping-column h4 { 
            font-size: 16px; 
            margin-bottom: 16px; 
            display: flex; 
            align-items: center; 
            gap: 10px; 
        }
        .housekeeping-column .badge { 
            font-size: 13px; 
            background: rgba(255,255,255,0.15); 
            padding: 4px 12px; 
            border-radius: 20px;
            font-weight: 600;
        }
        .request-indicator {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 12px;
            height: 12px;
            background: #ef4444;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        
        /* Accounting */
        .accounting-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 18px; 
            padding: 24px; 
        }
        .accounting-card { 
            background: rgba(255,255,255,0.04); 
            border: 1px solid rgba(255,255,255,0.08); 
            border-radius: 16px; 
            padding: 24px; 
        }
        .accounting-card h4 { font-size: 15px; color: rgba(255,255,255,0.6); margin-bottom: 10px; }
        .accounting-card .amount { font-size: 32px; font-weight: 800; }
        .accounting-card.income { border-left: 5px solid #22c55e; }
        .accounting-card.expense { border-left: 5px solid #ef4444; }
        .accounting-card.pending { border-left: 5px solid #f59e0b; }
        
        /* Modal */
        .modal-overlay { 
            position: fixed; inset: 0; 
            background: rgba(0,0,0,0.8); 
            display: flex; align-items: center; justify-content: center; 
            z-index: 1000; 
            animation: fadeIn 0.2s ease; 
            backdrop-filter: blur(5px);
        }
        .modal { 
            background: linear-gradient(180deg, #1e2433 0%, #171c28 100%); 
            border-radius: 20px; 
            padding: 28px; 
            max-width: 540px; 
            width: 92%; 
            max-height: 90vh; 
            overflow-y: auto; 
            animation: slideIn 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
        .modal-header h3 { font-size: 22px; font-weight: 700; }
        .modal-close { background: none; border: none; color: #fff; font-size: 28px; cursor: pointer; opacity: 0.6; }
        .modal-close:hover { opacity: 1; }
        .form-group { margin-bottom: 18px; }
        .form-group label { display: block; font-size: 14px; color: rgba(255,255,255,0.7); margin-bottom: 8px; font-weight: 500; }
        .form-input { 
            width: 100%; padding: 14px 16px; 
            background: rgba(255,255,255,0.06); 
            border: 1px solid rgba(255,255,255,0.12); 
            border-radius: 12px; 
            color: #fff; font-size: 16px; 
        }
        .form-input:focus { outline: none; border-color: #10b981; background: rgba(255,255,255,0.08); }
        
        /* Buttons */
        .btn-primary { 
            background: linear-gradient(135deg, #10b981 0%, #059669 100%); 
            color: white; border: none; 
            padding: 16px 28px; border-radius: 12px; 
            font-size: 16px; font-weight: 600; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            box-shadow: 0 4px 15px rgba(16,185,129,0.3);
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(16,185,129,0.4); }
        
        .search-btn { 
            display: flex; align-items: center; gap: 10px; 
            padding: 14px 24px; 
            background: rgba(255,255,255,0.06); 
            border: 1px solid rgba(255,255,255,0.15); 
            border-radius: 12px; 
            color: rgba(255,255,255,0.8); 
            cursor: pointer; font-size: 15px; 
            transition: all 0.3s ease; 
        }
        .search-btn:hover { background: rgba(255,255,255,0.12); color: #fff; border-color: #10b981; }
        
        .refresh-btn { 
            padding: 14px 24px; 
            background: rgba(255,255,255,0.08); 
            border: 1px solid rgba(255,255,255,0.15); 
            border-radius: 12px; 
            color: #fff; font-size: 15px; font-weight: 600; 
            cursor: pointer; transition: all 0.3s ease; 
            display: flex; align-items: center; gap: 10px; 
        }
        .refresh-btn:hover { background: #10b981; border-color: #10b981; }
        .refresh-btn.loading { animation: pulse 1s infinite; }
        
        /* Info Icon */
        .info-icon { 
            width: 28px; height: 28px; 
            background: rgba(255,255,255,0.15); 
            border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 14px; cursor: pointer; 
            transition: all 0.3s ease; 
        }
        .info-icon:hover { background: rgba(255,255,255,0.3); transform: scale(1.15); }
        
        /* Unit Selection */
        .unit-selected { box-shadow: 0 0 0 4px #10b981, 0 0 25px rgba(16,185,129,0.4); }
        
        /* Spinner */
        .spinner { 
            border: 3px solid rgba(255,255,255,0.1); 
            border-top-color: #10b981; 
            border-radius: 50%; 
            width: 22px; height: 22px; 
            animation: spin 0.8s linear infinite; 
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* Version Tag */
        .version-tag { position: fixed; bottom: 12px; right: 12px; font-size: 12px; color: rgba(255,255,255,0.3); }
        
        /* Responsive */
        @media (max-width: 768px) { 
            .stat-num { font-size: 28px; } 
            .top-bar { padding: 12px 14px; height: 64px; }
            .main-content { padding-top: 74px; }
            .date-header-wrapper { top: 64px; }
            .nav-btn { padding: 14px 14px; font-size: 14px; } 
            .room-card { padding: 12px 14px; } 
            .today-card { min-width: 100%; max-width: 100%; }
            .property-name { font-size: 17px; }
        }
        @media (max-width: 480px) {
            .tabs-row { gap: 6px; }
            .nav-btn { padding: 12px 10px; font-size: 13px; }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;
        
        // Beds24 API Configuration
        const PROPERTY = "miamibr";
        const PROXY = "https://beds24-proxy-1006186358018.us-central1.run.app";
        
        // FIXED: Bangladesh GMT+6 Time - Using Intl API for accurate timezone
        const formatBDDateTime = () => {
            const options = { 
                timeZone: 'Asia/Dhaka',
                weekday: 'short',
                month: 'short',
                day: 'numeric',
                hour: 'numeric',
                minute: '2-digit',
                hour12: true
            };
            return new Date().toLocaleString('en-US', options).replace(',', ' â€¢');
        };
        
        const getBDDate = (offset = 0) => {
            const now = new Date();
            // Get Bangladesh date using Intl
            const bdDateStr = now.toLocaleDateString('en-CA', { timeZone: 'Asia/Dhaka' });
            const bdDate = new Date(bdDateStr + 'T00:00:00');
            bdDate.setDate(bdDate.getDate() + offset);
            return bdDate.toISOString().split('T')[0];
        };
        
        const formatDateDisplay = (dateStr) => {
            const date = new Date(dateStr + 'T00:00:00');
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            return { 
                day: days[date.getDay()], 
                num: date.getDate(),
                month: months[date.getMonth()]
            };
        };
        
        // Room type mapping from Beds24
        const ROOM_TYPES = {
            583459: { name: 'Standard Room', category: 'Standard', rate: 3000 },
            583466: { name: 'Deluxe Room', category: 'Deluxe', rate: 4000 },
            583467: { name: 'Deluxe Plus', category: 'Deluxe', rate: 4500 },
            583468: { name: 'Premium Room', category: 'Premium', rate: 5000 },
            583469: { name: 'Premium Plus', category: 'Premium', rate: 5500 },
            583470: { name: 'Superior Room', category: 'Superior', rate: 6000 },
            583471: { name: 'Suite', category: 'Suite', rate: 7000 },
            583472: { name: 'Executive Suite', category: 'Suite', rate: 10000 }
        };
        
        // Fetch real bookings from Beds24 API
        const fetchBeds24Data = async () => {
            try {
                const response = await fetch(PROXY);
                const data = await response.json();
                if (data.success && data.data) {
                    return data.data;
                }
                return [];
            } catch (error) {
                console.error('Failed to fetch Beds24 data:', error);
                return [];
            }
        };
        
        // Transform Beds24 bookings to app format
        const transformBookings = (beds24Bookings) => {
            return beds24Bookings.map(b => ({
                id: String(b.id),
                roomId: String(b.unitId),
                unitId: String(b.unitId),
                roomTypeId: String(b.roomId),
                guestName: `${b.firstName || ''} ${b.lastName || ''}`.trim() || 'Guest',
                phone: b.mobile || b.phone || '',
                checkIn: b.arrival,
                checkOut: b.departure,
                status: b.status,
                numAdults: b.numAdult || 1,
                numChildren: b.numChild || 0,
                totalAmount: b.price || 0,
                paidAmount: b.deposit || 0,
                paymentMethod: 'Beds24',
                referer: b.referer || '',
                notes: b.notes || ''
            }));
        };
        
        // Extract unique rooms from bookings
        const extractRooms = (beds24Bookings) => {
            const roomMap = new Map();
            beds24Bookings.forEach(b => {
                const unitKey = String(b.unitId);
                if (!roomMap.has(unitKey)) {
                    const roomType = ROOM_TYPES[b.roomId] || { name: 'Room', category: 'Standard', rate: 3000 };
                    roomMap.set(unitKey, {
                        id: unitKey,
                        roomTypeId: String(b.roomId),
                        name: roomType.name,
                        floor: Math.ceil(b.unitId / 3),
                        category: roomType.category,
                        rate: roomType.rate
                    });
                }
            });
            // If no rooms found, create default 9 units
            if (roomMap.size === 0) {
                for (let i = 1; i <= 9; i++) {
                    roomMap.set(String(i), {
                        id: String(i),
                        roomTypeId: '583468',
                        name: 'Room ' + i,
                        floor: Math.ceil(i / 3),
                        category: 'Standard',
                        rate: 5000
                    });
                }
            }
            return Array.from(roomMap.values()).sort((a, b) => Number(a.id) - Number(b.id));
        };
        
        // Housekeeping requests
        const generateRequests = () => [];
        
        function App() {
            const [currentTime, setCurrentTime] = useState(formatBDDateTime());
            const [activeTab, setActiveTab] = useState('today');
            const [selectedDate, setSelectedDate] = useState(getBDDate());
            const [rooms, setRooms] = useState([]);
            const [bookings, setBookings] = useState([]);
            const [loading, setLoading] = useState(true);
            const [calendarView, setCalendarView] = useState('floor');
            const [bookingModal, setBookingModal] = useState(null);
            const [selectedUnits, setSelectedUnits] = useState([]);
            const [searchDates, setSearchDates] = useState({ checkIn: getBDDate(), checkOut: getBDDate(1) });
            const [dateSelectionMode, setDateSelectionMode] = useState('checkIn');
            const [housekeepingTab, setHousekeepingTab] = useState('today');
            const [requests, setRequests] = useState([]);
            
            // Fetch data on mount
            useEffect(() => {
                const loadData = async () => {
                    setLoading(true);
                    const beds24Data = await fetchBeds24Data();
                    const transformedBookings = transformBookings(beds24Data);
                    const extractedRooms = extractRooms(beds24Data);
                    setBookings(transformedBookings);
                    setRooms(extractedRooms);
                    setLoading(false);
                };
                loadData();
            }, []);
            
            // Update time every minute
            useEffect(() => {
                const timer = setInterval(() => setCurrentTime(formatBDDateTime()), 60000);
                return () => clearInterval(timer);
            }, []);
            }, []);
            
            const dateRange = Array.from({ length: 7 }, (_, i) => getBDDate(i));
            
            // Get today's stats
            const getStats = () => {
                const today = getBDDate();
                const occupied = bookings.filter(b => b.checkIn <= today && b.checkOut > today).length;
                return {
                    total: rooms.length,
                    available: rooms.length - occupied,
                    occupied,
                    checkIn: bookings.filter(b => b.checkIn === today).length,
                    checkOut: bookings.filter(b => b.checkOut === today).length
                };
            };
            const stats = getStats();
            
            // Notification count for housekeeping
            const pendingRequests = requests.filter(r => r.status === 'pending').length;
            
            // Tab configuration
            const tabs = [
                { id: 'today', label: 'ðŸ“… Today' },
                { id: 'calendar', label: 'ðŸ—“ï¸ Calendar' },
                { id: 'search', label: 'ðŸ” Search & Book' },
                { id: 'requests', label: 'ðŸ”” Requests' },
                { id: 'housekeeping', label: 'ðŸ§¹ Housekeeping', hasNotification: pendingRequests > 0, notificationCount: pendingRequests },
                { id: 'movements', label: 'ðŸš¶ Movements' },
                { id: 'accounting', label: 'ðŸ’° Accounting' }
            ];
            
            // Refresh handler
            const handleRefresh = async () => {
                setLoading(true);
                const beds24Data = await fetchBeds24Data();
                const transformedBookings = transformBookings(beds24Data);
                const extractedRooms = extractRooms(beds24Data);
                setBookings(transformedBookings);
                setRooms(extractedRooms);
                // Requests loaded from API
                setLoading(false);
            };
            
            // Get room status for a specific date
            const getRoomStatus = (roomId, date) => {
                const booking = bookings.find(b => b.roomId === roomId && b.checkIn <= date && b.checkOut > date);
                if (!booking) return { status: 'available', booking: null };
                if (booking.checkIn === date) return { status: 'checkin', booking };
                if (booking.checkOut === date) return { status: 'checkout', booking };
                return { status: 'occupied', booking };
            };
            
            // Search date click handler - AUTO CHECKOUT DATE SELECTION
            const handleSearchDateClick = (date) => {
                if (dateSelectionMode === 'checkIn') {
                    setSearchDates({ checkIn: date, checkOut: getBDDate(1) }); // Reset checkout
                    setDateSelectionMode('checkOut');
                } else {
                    if (date > searchDates.checkIn) {
                        setSearchDates({ ...searchDates, checkOut: date });
                        setDateSelectionMode('checkIn');
                    } else {
                        // If selected date is before or same as check-in, make it new check-in
                        setSearchDates({ checkIn: date, checkOut: searchDates.checkOut });
                    }
                }
            };
            
            // Unit click handler for multi-select
            const handleUnitClick = (room, date, checkOut = null) => {
                const key = room.id + '-' + date;
                const existing = selectedUnits.find(u => u.key === key);
                if (existing) {
                    setSelectedUnits(selectedUnits.filter(u => u.key !== key));
                } else {
                    setSelectedUnits([...selectedUnits, { 
                        key, 
                        roomId: room.id, 
                        checkIn: date,
                        checkOut: checkOut || getBDDate(1),
                        room 
                    }]);
                }
            };

            // RENDER: Today View - Centered and Responsive
            const renderTodayView = () => {
                const today = getBDDate();
                const checkIns = bookings.filter(b => b.checkIn === today);
                const checkOuts = bookings.filter(b => b.checkOut === today);
                const stayOvers = bookings.filter(b => b.checkIn < today && b.checkOut > today);
                const available = rooms.filter(r => !bookings.some(b => b.roomId === r.id && b.checkIn <= today && b.checkOut > today));
                
                return React.createElement('div', {className: 'today-grid animate-fade'},
                    // Check-ins Card
                    React.createElement('div', {className: 'today-card'},
                        React.createElement('h3', null, 'ðŸŸ¢ Check-ins ', React.createElement('span', {className: 'count'}, checkIns.length)),
                        checkIns.map(b => React.createElement('div', {
                            key: b.id, 
                            className: 'room-card checkin',
                            onClick: () => setBookingModal(b)
                        },
                            React.createElement('div', {className: 'room-num'}, b.roomId),
                            React.createElement('div', {className: 'room-info'},
                                React.createElement('div', {className: 'guest-name'}, b.guestName),
                                React.createElement('div', {className: 'room-type'}, rooms.find(r => r.id === b.roomId)?.name)
                            ),
                            React.createElement('div', {className: 'info-icon'}, 'â„¹ï¸')
                        )),
                        checkIns.length === 0 && React.createElement('div', {style: {color: 'rgba(255,255,255,0.4)', padding: '24px', textAlign: 'center', fontSize: '15px'}}, 'No check-ins today')
                    ),
                    
                    // Check-outs Card
                    React.createElement('div', {className: 'today-card'},
                        React.createElement('h3', null, 'ðŸŸ  Check-outs ', React.createElement('span', {className: 'count'}, checkOuts.length)),
                        checkOuts.map(b => React.createElement('div', {
                            key: b.id, 
                            className: 'room-card checkout',
                            onClick: () => setBookingModal(b)
                        },
                            React.createElement('div', {className: 'room-num'}, b.roomId),
                            React.createElement('div', {className: 'room-info'},
                                React.createElement('div', {className: 'guest-name'}, b.guestName),
                                React.createElement('div', {className: 'room-type'}, rooms.find(r => r.id === b.roomId)?.name)
                            ),
                            React.createElement('div', {className: 'info-icon'}, 'â„¹ï¸')
                        )),
                        checkOuts.length === 0 && React.createElement('div', {style: {color: 'rgba(255,255,255,0.4)', padding: '24px', textAlign: 'center', fontSize: '15px'}}, 'No check-outs today')
                    ),
                    
                    // Stay Over Card
                    React.createElement('div', {className: 'today-card'},
                        React.createElement('h3', null, 'ðŸ”µ Stay Over ', React.createElement('span', {className: 'count'}, stayOvers.length)),
                        stayOvers.slice(0, 6).map(b => React.createElement('div', {
                            key: b.id, 
                            className: 'room-card occupied',
                            onClick: () => setBookingModal(b)
                        },
                            React.createElement('div', {className: 'room-num'}, b.roomId),
                            React.createElement('div', {className: 'room-info'},
                                React.createElement('div', {className: 'guest-name'}, b.guestName),
                                React.createElement('div', {className: 'room-type'}, rooms.find(r => r.id === b.roomId)?.name)
                            )
                        )),
                        stayOvers.length === 0 && React.createElement('div', {style: {color: 'rgba(255,255,255,0.4)', padding: '24px', textAlign: 'center', fontSize: '15px'}}, 'No stay-overs')
                    ),
                    
                    // Available Card
                    React.createElement('div', {className: 'today-card'},
                        React.createElement('h3', null, 'âšª Available ', React.createElement('span', {className: 'count'}, available.length)),
                        available.map(room => {
                            const isSelected = selectedUnits.some(u => u.roomId === room.id && u.checkIn === today);
                            return React.createElement('div', {
                                key: room.id, 
                                className: 'room-card' + (isSelected ? ' unit-selected' : ''),
                                style: {background: 'rgba(255,255,255,0.1)'},
                                onClick: () => handleUnitClick(room, today)
                            },
                                React.createElement('div', {className: 'room-num'}, room.id),
                                React.createElement('div', {className: 'room-info'},
                                    React.createElement('div', {className: 'guest-name'}, 'Available'),
                                    React.createElement('div', {className: 'room-type'}, room.name)
                                )
                            );
                        }),
                        available.length === 0 && React.createElement('div', {style: {color: 'rgba(255,255,255,0.4)', padding: '24px', textAlign: 'center', fontSize: '15px'}}, 'No rooms available')
                    ),
                    
                    // Floating Book Button
                    selectedUnits.length > 0 && React.createElement('div', {
                        style: {position: 'fixed', bottom: '90px', left: '50%', transform: 'translateX(-50%)', zIndex: 100}
                    },
                        React.createElement('button', {
                            className: 'btn-primary',
                            style: {padding: '18px 36px', fontSize: '17px'},
                            onClick: () => setBookingModal({isNew: true, units: selectedUnits})
                        }, 'ðŸ“ Book ' + selectedUnits.length + ' Unit' + (selectedUnits.length > 1 ? 's' : ''))
                    )
                );
            };

            // RENDER: Calendar View with Floor/Category Toggle
            const renderCalendarView = () => {
                const groupedRooms = calendarView === 'floor' 
                    ? rooms.reduce((acc, room) => {
                        const key = 'Floor ' + room.floor;
                        if (!acc[key]) acc[key] = [];
                        acc[key].push(room);
                        return acc;
                    }, {})
                    : rooms.reduce((acc, room) => {
                        if (!acc[room.category]) acc[room.category] = [];
                        acc[room.category].push(room);
                        return acc;
                    }, {});
                
                return React.createElement('div', {className: 'animate-fade'},
                    // View Toggle - Centered
                    React.createElement('div', {style: {display: 'flex', justifyContent: 'center', padding: '16px 20px'}},
                        React.createElement('div', {className: 'view-toggle'},
                            React.createElement('button', {
                                className: calendarView === 'floor' ? 'active' : '',
                                onClick: () => setCalendarView('floor')
                            }, 'ðŸ¢ By Floor'),
                            React.createElement('button', {
                                className: calendarView === 'category' ? 'active' : '',
                                onClick: () => setCalendarView('category')
                            }, 'ðŸ“ By Category')
                        )
                    ),
                    
                    // Date Header - Sticky and Separated
                    React.createElement('div', {className: 'date-header-wrapper'},
                        React.createElement('div', {className: 'date-header-inner'},
                            dateRange.map(date => {
                                const fd = formatDateDisplay(date);
                                return React.createElement('div', {
                                    key: date,
                                    className: 'date-cell ' + (date === selectedDate ? 'active' : ''),
                                    onClick: () => setSelectedDate(date)
                                },
                                    React.createElement('div', {className: 'day-name'}, fd.day),
                                    React.createElement('div', {className: 'day-num'}, fd.num)
                                );
                            })
                        )
                    ),
                    
                    // Room Grid by Group
                    React.createElement('div', {style: {padding: '20px'}},
                        Object.entries(groupedRooms).map(([group, groupRooms]) =>
                            React.createElement('div', {key: group, style: {marginBottom: '24px'}},
                                React.createElement('h3', {style: {fontSize: '17px', marginBottom: '14px', color: 'rgba(255,255,255,0.7)', fontWeight: '600'}}, group),
                                React.createElement('div', {style: {display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(160px, 1fr))', gap: '12px'}},
                                    groupRooms.map(room => {
                                        const rs = getRoomStatus(room.id, selectedDate);
                                        const isSelected = selectedUnits.some(u => u.roomId === room.id && u.checkIn === selectedDate);
                                        const hasRequest = requests.some(r => r.roomId === room.id && r.status === 'pending');
                                        
                                        return React.createElement('div', {
                                            key: room.id,
                                            className: 'room-card ' + rs.status + (isSelected ? ' unit-selected' : ''),
                                            onClick: () => rs.booking ? setBookingModal(rs.booking) : handleUnitClick(room, selectedDate),
                                            style: {flexDirection: 'column', alignItems: 'flex-start', minHeight: '90px', position: 'relative'}
                                        },
                                            hasRequest && React.createElement('div', {className: 'request-indicator'}),
                                            React.createElement('div', {style: {display: 'flex', justifyContent: 'space-between', width: '100%', alignItems: 'center'}},
                                                React.createElement('div', {className: 'room-num'}, room.id),
                                                React.createElement('div', {className: 'info-icon', onClick: (e) => { e.stopPropagation(); setBookingModal(rs.booking || {roomId: room.id, room, isRoomInfo: true}); }}, 'â„¹ï¸')
                                            ),
                                            React.createElement('div', {className: 'guest-name', style: {marginTop: '6px'}}, rs.booking?.guestName || 'Available'),
                                            React.createElement('div', {className: 'room-type'}, room.name)
                                        );
                                    })
                                )
                            )
                        )
                    ),
                    
                    // Floating Book Button
                    selectedUnits.length > 0 && React.createElement('div', {
                        style: {position: 'fixed', bottom: '90px', left: '50%', transform: 'translateX(-50%)', zIndex: 100}
                    },
                        React.createElement('button', {
                            className: 'btn-primary',
                            style: {padding: '18px 36px', fontSize: '17px'},
                            onClick: () => setBookingModal({isNew: true, units: selectedUnits})
                        }, 'ðŸ“ Book ' + selectedUnits.length + ' Unit' + (selectedUnits.length > 1 ? 's' : ''))
                    )
                );
            };

            // RENDER: Search & Book View - Centered, Colored, Auto Checkout
            const renderSearchView = () => {
                const availableRooms = rooms.filter(room => 
                    !bookings.some(b => b.roomId === room.id && b.checkIn < searchDates.checkOut && b.checkOut > searchDates.checkIn)
                );
                const nights = Math.ceil((new Date(searchDates.checkOut) - new Date(searchDates.checkIn)) / (1000 * 60 * 60 * 24));
                
                return React.createElement('div', {className: 'animate-fade', style: {padding: '24px'}},
                    // Date Selectors - Centered
                    React.createElement('div', {style: {display: 'flex', justifyContent: 'center', gap: '20px', marginBottom: '28px', flexWrap: 'wrap'}},
                        React.createElement('div', {
                            className: 'date-selector ' + (dateSelectionMode === 'checkIn' ? 'active' : ''),
                            onClick: () => setDateSelectionMode('checkIn')
                        },
                            React.createElement('div', {className: 'label'}, 'Check-in'),
                            React.createElement('div', {className: 'date'}, searchDates.checkIn)
                        ),
                        React.createElement('div', {style: {display: 'flex', alignItems: 'center', fontSize: '24px', color: 'rgba(255,255,255,0.3)'}}, 'â†’'),
                        React.createElement('div', {
                            className: 'date-selector ' + (dateSelectionMode === 'checkOut' ? 'active' : ''),
                            onClick: () => setDateSelectionMode('checkOut')
                        },
                            React.createElement('div', {className: 'label'}, 'Check-out'),
                            React.createElement('div', {className: 'date'}, searchDates.checkOut)
                        ),
                        React.createElement('div', {style: {display: 'flex', alignItems: 'center', padding: '10px 20px', background: 'rgba(255,255,255,0.05)', borderRadius: '12px'}},
                            React.createElement('span', {style: {fontSize: '18px', fontWeight: '700'}}, nights + ' Night' + (nights > 1 ? 's' : ''))
                        )
                    ),
                    
                    // Instruction
                    React.createElement('div', {style: {textAlign: 'center', marginBottom: '16px', color: 'rgba(255,255,255,0.5)', fontSize: '14px'}},
                        dateSelectionMode === 'checkIn' ? 'ðŸ‘† Select check-in date below' : 'ðŸ‘† Now select check-out date'
                    ),
                    
                    // Date Range Selector
                    React.createElement('div', {className: 'date-header-wrapper', style: {position: 'relative', marginBottom: '28px', borderRadius: '14px'}},
                        React.createElement('div', {className: 'date-header-inner'},
                            Array.from({length: 14}, (_, i) => getBDDate(i)).map(date => {
                                const fd = formatDateDisplay(date);
                                const isCheckIn = date === searchDates.checkIn;
                                const isCheckOut = date === searchDates.checkOut;
                                const isInRange = date > searchDates.checkIn && date < searchDates.checkOut;
                                
                                return React.createElement('div', {
                                    key: date,
                                    className: 'date-cell ' + ((isCheckIn || isCheckOut) ? 'active' : ''),
                                    style: {background: isInRange ? 'rgba(16,185,129,0.25)' : undefined},
                                    onClick: () => handleSearchDateClick(date)
                                },
                                    React.createElement('div', {className: 'day-name'}, fd.day),
                                    React.createElement('div', {className: 'day-num'}, fd.num),
                                    (isCheckIn || isCheckOut) && React.createElement('div', {style: {fontSize: '10px', marginTop: '4px', fontWeight: '600'}}, isCheckIn ? 'IN' : 'OUT')
                                );
                            })
                        )
                    ),
                    
                    // Results Header
                    React.createElement('h3', {style: {textAlign: 'center', marginBottom: '20px', fontSize: '20px', fontWeight: '700'}}, 
                        availableRooms.length + ' Room' + (availableRooms.length !== 1 ? 's' : '') + ' Available'
                    ),
                    
                    // Search Results - Centered and Colored
                    React.createElement('div', {className: 'search-results'},
                        rooms.map(room => {
                            const isAvailable = availableRooms.includes(room);
                            const isSelected = selectedUnits.some(u => u.roomId === room.id);
                            
                            return React.createElement('div', {
                                key: room.id,
                                className: 'search-result-card ' + (isAvailable ? 'available' : 'occupied') + (isSelected ? ' unit-selected' : ''),
                                onClick: () => isAvailable && handleUnitClick(room, searchDates.checkIn, searchDates.checkOut)
                            },
                                React.createElement('div', {className: 'room-number'}, room.id),
                                React.createElement('div', {className: 'room-status'}, isAvailable ? 'âœ“ Available' : 'âœ— Occupied'),
                                React.createElement('div', {style: {fontSize: '12px', marginTop: '6px', opacity: 0.85}}, room.name),
                                isAvailable && React.createElement('div', {style: {fontSize: '13px', marginTop: '6px', fontWeight: '600'}}, 'à§³' + (room.rate * nights).toLocaleString())
                            );
                        })
                    ),
                    
                    // Floating Book Button
                    selectedUnits.length > 0 && React.createElement('div', {
                        style: {position: 'fixed', bottom: '90px', left: '50%', transform: 'translateX(-50%)', zIndex: 100}
                    },
                        React.createElement('button', {
                            className: 'btn-primary',
                            style: {padding: '18px 36px', fontSize: '17px'},
                            onClick: () => setBookingModal({isNew: true, units: selectedUnits, checkIn: searchDates.checkIn, checkOut: searchDates.checkOut})
                        }, 'ðŸ“ Book ' + selectedUnits.length + ' Unit' + (selectedUnits.length > 1 ? 's' : ''))
                    )
                );
            };

            // RENDER: Housekeeping View with Today/Tomorrow tabs and Request indicators
            const renderHousekeepingView = () => {
                const today = getBDDate();
                const tomorrow = getBDDate(1);
                const targetDate = housekeepingTab === 'today' ? today : tomorrow;
                
                const checkOuts = bookings.filter(b => b.checkOut === targetDate);
                const checkIns = bookings.filter(b => b.checkIn === targetDate);
                const stayOvers = bookings.filter(b => b.checkIn < targetDate && b.checkOut > targetDate);
                const turnovers = checkOuts.filter(co => checkIns.some(ci => ci.roomId === co.roomId));
                const newCheckIns = checkIns.filter(ci => !turnovers.some(t => t.roomId === ci.roomId));
                
                const roomRequests = requests.reduce((acc, r) => {
                    acc[r.roomId] = r;
                    return acc;
                }, {});
                
                const handleRequestAction = (reqId, action, staffName = '') => {
                    setRequests(requests.map(r => {
                        if (r.id === reqId) {
                            return { ...r, status: action, staffName: staffName || r.staffName };
                        }
                        return r;
                    }));
                };
                
                const RoomCardWithRequest = ({ booking, type, bgClass }) => {
                    const room = rooms.find(r => r.id === booking.roomId);
                    const req = roomRequests[booking.roomId];
                    
                    return React.createElement('div', {
                        className: 'room-card ' + bgClass,
                        style: {position: 'relative'},
                        onClick: () => setBookingModal(booking)
                    },
                        req && req.status === 'pending' && React.createElement('div', {className: 'request-indicator', title: req.type}),
                        React.createElement('div', {className: 'room-num'}, booking.roomId),
                        React.createElement('div', {className: 'room-info'},
                            React.createElement('div', {className: 'guest-name'}, booking.guestName),
                            React.createElement('div', {className: 'room-type'}, type),
                            req && React.createElement('div', {style: {fontSize: '11px', marginTop: '4px', padding: '2px 8px', background: 'rgba(0,0,0,0.3)', borderRadius: '4px', display: 'inline-block'}}, 
                                'ðŸ“‹ ' + req.type + ' - ' + req.status
                            )
                        )
                    );
                };
                
                return React.createElement('div', {className: 'animate-fade', style: {padding: '16px'}},
                    // Today/Tomorrow Toggle
                    React.createElement('div', {style: {display: 'flex', justifyContent: 'center', marginBottom: '24px'}},
                        React.createElement('div', {className: 'view-toggle'},
                            React.createElement('button', {
                                className: housekeepingTab === 'today' ? 'active' : '',
                                onClick: () => setHousekeepingTab('today')
                            }, 'ðŸ“… Today'),
                            React.createElement('button', {
                                className: housekeepingTab === 'tomorrow' ? 'active' : '',
                                onClick: () => setHousekeepingTab('tomorrow')
                            }, 'ðŸ“† Tomorrow')
                        )
                    ),
                    
                    // Date Header
                    React.createElement('h2', {style: {textAlign: 'center', marginBottom: '24px', fontSize: '20px', fontWeight: '700'}}, 
                        'ðŸ§¹ Housekeeping - ' + (housekeepingTab === 'today' ? 'Today' : 'Tomorrow') + ' (' + formatDateDisplay(targetDate).day + ', ' + formatDateDisplay(targetDate).month + ' ' + formatDateDisplay(targetDate).num + ')'
                    ),
                    
                    // Grid
                    React.createElement('div', {className: 'housekeeping-grid'},
                        // Check-out / Dirty
                        React.createElement('div', {className: 'housekeeping-column'},
                            React.createElement('h4', null, 'ðŸŸ  Check-out (Dirty) ', React.createElement('span', {className: 'badge'}, checkOuts.length)),
                            checkOuts.filter(co => !turnovers.some(t => t.roomId === co.roomId)).map(b => 
                                React.createElement(RoomCardWithRequest, {key: b.id, booking: b, type: 'Check-out', bgClass: 'dirty'})
                            ),
                            checkOuts.filter(co => !turnovers.some(t => t.roomId === co.roomId)).length === 0 && 
                                React.createElement('div', {style: {color: 'rgba(255,255,255,0.4)', padding: '20px', textAlign: 'center'}}, 'None')
                        ),
                        
                        // Turnover
                        React.createElement('div', {className: 'housekeeping-column'},
                            React.createElement('h4', null, 'ðŸ”„ Turnover ', React.createElement('span', {className: 'badge'}, turnovers.length)),
                            turnovers.map(b => {
                                const nextGuest = checkIns.find(ci => ci.roomId === b.roomId);
                                return React.createElement('div', {key: b.id, className: 'room-card turnover', onClick: () => setBookingModal(b)},
                                    React.createElement('div', {className: 'room-num'}, b.roomId),
                                    React.createElement('div', {className: 'room-info'},
                                        React.createElement('div', {style: {fontSize: '12px', opacity: 0.8}}, 'â¬† OUT: ' + b.guestName),
                                        React.createElement('div', {style: {fontSize: '14px', fontWeight: '600', marginTop: '4px'}}, 'â¬‡ IN: ' + (nextGuest?.guestName || ''))
                                    )
                                );
                            }),
                            turnovers.length === 0 && React.createElement('div', {style: {color: 'rgba(255,255,255,0.4)', padding: '20px', textAlign: 'center'}}, 'None')
                        ),
                        
                        // Stay Over
                        React.createElement('div', {className: 'housekeeping-column'},
                            React.createElement('h4', null, 'ðŸ”µ Stay Over ', React.createElement('span', {className: 'badge'}, stayOvers.length)),
                            stayOvers.map(b => React.createElement(RoomCardWithRequest, {key: b.id, booking: b, type: 'Staying', bgClass: 'occupied'})),
                            stayOvers.length === 0 && React.createElement('div', {style: {color: 'rgba(255,255,255,0.4)', padding: '20px', textAlign: 'center'}}, 'None')
                        ),
                        
                        // New Check-in
                        React.createElement('div', {className: 'housekeeping-column'},
                            React.createElement('h4', null, 'ðŸŸ¢ New Check-in ', React.createElement('span', {className: 'badge'}, newCheckIns.length)),
                            newCheckIns.map(b => React.createElement(RoomCardWithRequest, {key: b.id, booking: b, type: 'Arriving', bgClass: 'checkin'})),
                            newCheckIns.length === 0 && React.createElement('div', {style: {color: 'rgba(255,255,255,0.4)', padding: '20px', textAlign: 'center'}}, 'None')
                        )
                    )
                );
            };

            // RENDER: Requests View
            const renderRequestsView = () => {
                const pendingReqs = requests.filter(r => r.status === 'pending');
                const receivedReqs = requests.filter(r => r.status === 'received');
                const doneReqs = requests.filter(r => r.status === 'done');
                const deniedReqs = requests.filter(r => r.status === 'denied');
                
                const handleAction = (reqId, action) => {
                    if (action === 'done') {
                        const staffName = prompt('Enter staff name who completed this request:');
                        if (staffName) {
                            setRequests(requests.map(r => r.id === reqId ? {...r, status: action, staffName, completedAt: new Date().toLocaleTimeString()} : r));
                        }
                    } else {
                        setRequests(requests.map(r => r.id === reqId ? {...r, status: action} : r));
                    }
                };
                
                const RequestCard = ({ req }) => (
                    React.createElement('div', {style: {background: 'rgba(255,255,255,0.05)', borderRadius: '12px', padding: '16px', marginBottom: '12px'}},
                        React.createElement('div', {style: {display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '12px'}},
                            React.createElement('div', null,
                                React.createElement('div', {style: {fontSize: '18px', fontWeight: '700'}}, 'Room ' + req.roomId),
                                React.createElement('div', {style: {fontSize: '14px', color: 'rgba(255,255,255,0.6)'}}, req.type),
                                React.createElement('div', {style: {fontSize: '12px', color: 'rgba(255,255,255,0.4)', marginTop: '4px'}}, 'ðŸ• ' + req.time)
                            ),
                            React.createElement('div', {style: {
                                padding: '4px 12px', 
                                borderRadius: '20px', 
                                fontSize: '12px', 
                                fontWeight: '600',
                                background: req.status === 'pending' ? '#f59e0b' : req.status === 'received' ? '#3b82f6' : req.status === 'done' ? '#22c55e' : '#ef4444'
                            }}, req.status.toUpperCase())
                        ),
                        req.status === 'pending' && React.createElement('div', {style: {display: 'flex', gap: '8px'}},
                            React.createElement('button', {onClick: () => handleAction(req.id, 'received'), style: {flex: 1, padding: '10px', background: '#3b82f6', border: 'none', borderRadius: '8px', color: '#fff', cursor: 'pointer', fontWeight: '600'}}, 'âœ“ Received'),
                            React.createElement('button', {onClick: () => handleAction(req.id, 'denied'), style: {flex: 1, padding: '10px', background: '#ef4444', border: 'none', borderRadius: '8px', color: '#fff', cursor: 'pointer', fontWeight: '600'}}, 'âœ— Deny')
                        ),
                        req.status === 'received' && React.createElement('button', {onClick: () => handleAction(req.id, 'done'), style: {width: '100%', padding: '10px', background: '#22c55e', border: 'none', borderRadius: '8px', color: '#fff', cursor: 'pointer', fontWeight: '600'}}, 'âœ“ Mark Done'),
                        req.status === 'done' && req.staffName && React.createElement('div', {style: {fontSize: '12px', color: 'rgba(255,255,255,0.5)', marginTop: '8px'}}, 'âœ“ Completed by: ' + req.staffName + ' at ' + (req.completedAt || ''))
                    )
                );
                
                return React.createElement('div', {className: 'animate-fade', style: {padding: '24px'}},
                    React.createElement('h2', {style: {textAlign: 'center', marginBottom: '24px', fontSize: '20px'}}, 'ðŸ”” Guest Requests'),
                    
                    React.createElement('div', {style: {display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '20px'}},
                        // Pending
                        React.createElement('div', null,
                            React.createElement('h3', {style: {marginBottom: '16px', color: '#f59e0b'}}, 'â³ Pending (' + pendingReqs.length + ')'),
                            pendingReqs.map(req => React.createElement(RequestCard, {key: req.id, req})),
                            pendingReqs.length === 0 && React.createElement('div', {style: {color: 'rgba(255,255,255,0.4)', textAlign: 'center', padding: '20px'}}, 'No pending requests')
                        ),
                        // Received / In Progress
                        React.createElement('div', null,
                            React.createElement('h3', {style: {marginBottom: '16px', color: '#3b82f6'}}, 'ðŸ”„ In Progress (' + receivedReqs.length + ')'),
                            receivedReqs.map(req => React.createElement(RequestCard, {key: req.id, req})),
                            receivedReqs.length === 0 && React.createElement('div', {style: {color: 'rgba(255,255,255,0.4)', textAlign: 'center', padding: '20px'}}, 'None in progress')
                        ),
                        // Completed
                        React.createElement('div', null,
                            React.createElement('h3', {style: {marginBottom: '16px', color: '#22c55e'}}, 'âœ“ Completed (' + doneReqs.length + ')'),
                            doneReqs.map(req => React.createElement(RequestCard, {key: req.id, req})),
                            doneReqs.length === 0 && React.createElement('div', {style: {color: 'rgba(255,255,255,0.4)', textAlign: 'center', padding: '20px'}}, 'None completed today')
                        )
                    )
                );
            };

            // RENDER: Accounting View
            const renderAccountingView = () => {
                const today = getBDDate();
                
                // Calculate financials
                const todayCheckIns = bookings.filter(b => b.checkIn === today);
                const todayCheckOuts = bookings.filter(b => b.checkOut === today);
                const allActiveBookings = bookings.filter(b => b.checkIn <= today && b.checkOut >= today);
                
                const cashPayments = bookings.filter(b => b.paymentMethod === 'Cash').reduce((sum, b) => sum + (b.paidAmount || 0), 0);
                const bkashPayments = bookings.filter(b => b.paymentMethod === 'bKash').reduce((sum, b) => sum + (b.paidAmount || 0), 0);
                const bankPayments = bookings.filter(b => b.paymentMethod === 'Bank').reduce((sum, b) => sum + (b.paidAmount || 0), 0);
                
                const totalCollected = bookings.reduce((sum, b) => sum + (b.paidAmount || 0), 0);
                const totalDues = bookings.reduce((sum, b) => sum + ((b.totalAmount || 0) - (b.paidAmount || 0)), 0);
                const expectedFromCheckIns = todayCheckIns.reduce((sum, b) => sum + ((b.totalAmount || 0) - (b.paidAmount || 0)), 0);
                const checkOutCollections = todayCheckOuts.reduce((sum, b) => sum + ((b.totalAmount || 0) - (b.paidAmount || 0)), 0);
                
                return React.createElement('div', {className: 'animate-fade', style: {padding: '24px'}},
                    React.createElement('h2', {style: {textAlign: 'center', marginBottom: '28px', fontSize: '22px', fontWeight: '700'}}, 'ðŸ’° Accounting Dashboard'),
                    
                    // Summary Cards
                    React.createElement('div', {className: 'accounting-grid'},
                        React.createElement('div', {className: 'accounting-card income'},
                            React.createElement('h4', null, 'ðŸ’µ Total Collected Today'),
                            React.createElement('div', {className: 'amount', style: {color: '#22c55e'}}, 'à§³' + totalCollected.toLocaleString())
                        ),
                        React.createElement('div', {className: 'accounting-card pending'},
                            React.createElement('h4', null, 'â³ Expected from Check-ins'),
                            React.createElement('div', {className: 'amount', style: {color: '#f59e0b'}}, 'à§³' + expectedFromCheckIns.toLocaleString())
                        ),
                        React.createElement('div', {className: 'accounting-card pending'},
                            React.createElement('h4', null, 'ðŸ”„ Check-out Bills Due'),
                            React.createElement('div', {className: 'amount', style: {color: '#f59e0b'}}, 'à§³' + checkOutCollections.toLocaleString())
                        ),
                        React.createElement('div', {className: 'accounting-card expense'},
                            React.createElement('h4', null, 'ðŸ“Š Total Outstanding Dues'),
                            React.createElement('div', {className: 'amount', style: {color: '#ef4444'}}, 'à§³' + totalDues.toLocaleString())
                        )
                    ),
                    
                    // Payment Methods Breakdown
                    React.createElement('h3', {style: {marginTop: '32px', marginBottom: '20px', fontSize: '18px'}}, 'ðŸ’³ Payment Methods'),
                    React.createElement('div', {className: 'accounting-grid'},
                        React.createElement('div', {className: 'accounting-card'},
                            React.createElement('h4', null, 'ðŸ’µ Cash at Hand'),
                            React.createElement('div', {className: 'amount'}, 'à§³' + cashPayments.toLocaleString()),
                            React.createElement('div', {style: {fontSize: '13px', color: 'rgba(255,255,255,0.5)', marginTop: '8px'}}, bookings.filter(b => b.paymentMethod === 'Cash').length + ' transactions')
                        ),
                        React.createElement('div', {className: 'accounting-card'},
                            React.createElement('h4', null, 'ðŸ“± bKash Collection'),
                            React.createElement('div', {className: 'amount', style: {color: '#e91e8c'}}, 'à§³' + bkashPayments.toLocaleString()),
                            React.createElement('div', {style: {fontSize: '13px', color: 'rgba(255,255,255,0.5)', marginTop: '8px'}}, bookings.filter(b => b.paymentMethod === 'bKash').length + ' transactions')
                        ),
                        React.createElement('div', {className: 'accounting-card'},
                            React.createElement('h4', null, 'ðŸ¦ Bank Transfer'),
                            React.createElement('div', {className: 'amount', style: {color: '#3b82f6'}}, 'à§³' + bankPayments.toLocaleString()),
                            React.createElement('div', {style: {fontSize: '13px', color: 'rgba(255,255,255,0.5)', marginTop: '8px'}}, bookings.filter(b => b.paymentMethod === 'Bank').length + ' transactions')
                        )
                    ),
                    
                    // Recent Transactions
                    React.createElement('h3', {style: {marginTop: '32px', marginBottom: '20px', fontSize: '18px'}}, 'ðŸ“‹ Recent Transactions'),
                    React.createElement('div', {style: {background: 'rgba(255,255,255,0.03)', borderRadius: '16px', overflow: 'hidden'}},
                        bookings.slice(0, 8).map((b, idx) => 
                            React.createElement('div', {
                                key: b.id,
                                style: {
                                    display: 'flex', 
                                    justifyContent: 'space-between', 
                                    alignItems: 'center', 
                                    padding: '16px 20px', 
                                    borderBottom: idx < 7 ? '1px solid rgba(255,255,255,0.05)' : 'none'
                                }
                            },
                                React.createElement('div', null,
                                    React.createElement('div', {style: {fontWeight: '600', fontSize: '15px'}}, b.guestName),
                                    React.createElement('div', {style: {fontSize: '13px', color: 'rgba(255,255,255,0.5)'}}, 'Room ' + b.roomId + ' â€¢ ' + b.checkIn)
                                ),
                                React.createElement('div', {style: {textAlign: 'right'}},
                                    React.createElement('div', {style: {color: '#22c55e', fontWeight: '700', fontSize: '16px'}}, '+à§³' + (b.paidAmount || 0).toLocaleString()),
                                    React.createElement('div', {style: {fontSize: '12px', color: 'rgba(255,255,255,0.4)'}}, b.paymentMethod),
                                    (b.totalAmount - b.paidAmount) > 0 && React.createElement('div', {style: {fontSize: '11px', color: '#ef4444'}}, 'Due: à§³' + (b.totalAmount - b.paidAmount).toLocaleString())
                                )
                            )
                        )
                    )
                );
            };

            // Render content based on active tab
            const renderContent = () => {
                switch(activeTab) {
                    case 'today': return renderTodayView();
                    case 'calendar': return renderCalendarView();
                    case 'search': return renderSearchView();
                    case 'housekeeping': return renderHousekeepingView();
                    case 'accounting': return renderAccountingView();
                    case 'requests': return renderRequestsView();
                    case 'movements': 
                        return React.createElement('div', {className: 'animate-fade', style: {padding: '24px', textAlign: 'center'}},
                            React.createElement('h2', {style: {fontSize: '20px', marginBottom: '20px'}}, 'ðŸš¶ Room Movements'),
                            React.createElement('div', {style: {color: 'rgba(255,255,255,0.5)'}}, 'No room changes today')
                        );
                    default: return renderTodayView();
                }
            };

            // Booking/Info Modal
            const renderBookingModal = () => {
                if (!bookingModal) return null;
                const isNew = bookingModal.isNew;
                const isRoomInfo = bookingModal.isRoomInfo;
                
                return React.createElement('div', {className: 'modal-overlay', onClick: () => { setBookingModal(null); setSelectedUnits([]); }},
                    React.createElement('div', {className: 'modal', onClick: e => e.stopPropagation()},
                        React.createElement('div', {className: 'modal-header'},
                            React.createElement('h3', null, isNew ? 'âž• New Booking' : isRoomInfo ? 'ðŸ¨ Room Info' : 'ðŸ“‹ Booking Details'),
                            React.createElement('button', {className: 'modal-close', onClick: () => { setBookingModal(null); setSelectedUnits([]); }}, 'Ã—')
                        ),
                        
                        isNew ? (
                            // New Booking Form
                            React.createElement('div', null,
                                // Selected Units
                                React.createElement('div', {style: {marginBottom: '20px', padding: '14px', background: 'rgba(16,185,129,0.1)', borderRadius: '12px', border: '1px solid rgba(16,185,129,0.3)'}},
                                    React.createElement('strong', {style: {fontSize: '14px'}}, 'Selected Units: ' + (bookingModal.units?.length || 0)),
                                    React.createElement('div', {style: {marginTop: '10px', display: 'flex', flexWrap: 'wrap', gap: '8px'}},
                                        bookingModal.units?.map(u => 
                                            React.createElement('span', {key: u.key, style: {padding: '6px 14px', background: '#10b981', borderRadius: '8px', fontSize: '14px', fontWeight: '600'}}, 
                                                'Room ' + u.roomId
                                            )
                                        )
                                    )
                                ),
                                
                                // Guest Name
                                React.createElement('div', {className: 'form-group'},
                                    React.createElement('label', null, 'Guest Name *'),
                                    React.createElement('input', {type: 'text', className: 'form-input', placeholder: 'Enter guest name'})
                                ),
                                React.createElement('div', {className: 'form-group'},
                                    React.createElement('label', null, 'Phone Number'),
                                    React.createElement('input', {type: 'tel', className: 'form-input', placeholder: '01XXXXXXXXX'})
                                ),
                                
                                // Dates
                                React.createElement('div', {style: {display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '14px'}},
                                    React.createElement('div', {className: 'form-group'},
                                        React.createElement('label', null, 'Check-in'),
                                        React.createElement('input', {type: 'date', className: 'form-input', defaultValue: bookingModal.checkIn || searchDates.checkIn})
                                    ),
                                    React.createElement('div', {className: 'form-group'},
                                        React.createElement('label', null, 'Check-out'),
                                        React.createElement('input', {type: 'date', className: 'form-input', defaultValue: bookingModal.checkOut || searchDates.checkOut})
                                    )
                                ),
                                
                                // Guests
                                React.createElement('div', {style: {display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '14px'}},
                                    React.createElement('div', {className: 'form-group'},
                                        React.createElement('label', null, 'Adults'),
                                        React.createElement('input', {type: 'number', className: 'form-input', defaultValue: '2', min: '1'})
                                    ),
                                    React.createElement('div', {className: 'form-group'},
                                        React.createElement('label', null, 'Children'),
                                        React.createElement('input', {type: 'number', className: 'form-input', defaultValue: '0', min: '0'})
                                    )
                                ),
                                
                                // Payment
                                React.createElement('div', {style: {display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '14px'}},
                                    React.createElement('div', {className: 'form-group'},
                                        React.createElement('label', null, 'Total Amount (à§³)'),
                                        React.createElement('input', {type: 'number', className: 'form-input', placeholder: '0'})
                                    ),
                                    React.createElement('div', {className: 'form-group'},
                                        React.createElement('label', null, 'Advance Payment (à§³)'),
                                        React.createElement('input', {type: 'number', className: 'form-input', placeholder: '0'})
                                    )
                                ),
                                
                                React.createElement('div', {className: 'form-group'},
                                    React.createElement('label', null, 'Payment Method'),
                                    React.createElement('select', {className: 'form-input'},
                                        React.createElement('option', {value: 'Cash'}, 'Cash'),
                                        React.createElement('option', {value: 'bKash'}, 'bKash'),
                                        React.createElement('option', {value: 'Bank'}, 'Bank Transfer')
                                    )
                                ),
                                
                                React.createElement('button', {className: 'btn-primary', style: {width: '100%', marginTop: '12px'}}, 'âœ“ Confirm Booking & Sync to Beds24')
                            )
                        ) : isRoomInfo ? (
                            // Room Info
                            React.createElement('div', null,
                                React.createElement('div', {style: {padding: '20px', background: 'rgba(255,255,255,0.05)', borderRadius: '12px', textAlign: 'center'}},
                                    React.createElement('div', {style: {fontSize: '28px', fontWeight: '800', marginBottom: '8px'}}, 'Room ' + bookingModal.roomId),
                                    React.createElement('div', {style: {color: 'rgba(255,255,255,0.6)', fontSize: '15px'}}, bookingModal.room?.name),
                                    React.createElement('div', {style: {marginTop: '12px', fontSize: '22px', color: '#10b981', fontWeight: '700'}}, 'à§³' + (bookingModal.room?.rate || 0).toLocaleString() + '/night')
                                )
                            )
                        ) : (
                            // Existing Booking Details
                            React.createElement('div', null,
                                // Guest Info
                                React.createElement('div', {style: {padding: '20px', background: 'rgba(255,255,255,0.05)', borderRadius: '14px', marginBottom: '20px'}},
                                    React.createElement('div', {style: {fontSize: '26px', fontWeight: '800', marginBottom: '6px'}}, bookingModal.guestName),
                                    React.createElement('div', {style: {color: 'rgba(255,255,255,0.6)', fontSize: '15px'}}, 'Room ' + bookingModal.roomId + ' â€¢ ' + (rooms.find(r => r.id === bookingModal.roomId)?.name || '')),
                                    bookingModal.phone && React.createElement('div', {style: {marginTop: '8px', color: 'rgba(255,255,255,0.5)'}}, 'ðŸ“ž ' + bookingModal.phone)
                                ),
                                
                                // Dates
                                React.createElement('div', {style: {display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '14px', marginBottom: '20px'}},
                                    React.createElement('div', {style: {padding: '14px', background: 'rgba(255,255,255,0.03)', borderRadius: '10px'}},
                                        React.createElement('div', {style: {fontSize: '12px', color: 'rgba(255,255,255,0.5)', marginBottom: '4px'}}, 'Check-in'),
                                        React.createElement('div', {style: {fontWeight: '700', fontSize: '16px'}}, bookingModal.checkIn)
                                    ),
                                    React.createElement('div', {style: {padding: '14px', background: 'rgba(255,255,255,0.03)', borderRadius: '10px'}},
                                        React.createElement('div', {style: {fontSize: '12px', color: 'rgba(255,255,255,0.5)', marginBottom: '4px'}}, 'Check-out'),
                                        React.createElement('div', {style: {fontWeight: '700', fontSize: '16px'}}, bookingModal.checkOut)
                                    )
                                ),
                                
                                // Payment Summary
                                React.createElement('div', {style: {display: 'grid', gridTemplateColumns: '1fr 1fr 1fr', gap: '12px', marginBottom: '20px'}},
                                    React.createElement('div', {style: {textAlign: 'center', padding: '14px', background: 'rgba(255,255,255,0.03)', borderRadius: '10px'}},
                                        React.createElement('div', {style: {fontSize: '12px', color: 'rgba(255,255,255,0.5)'}}, 'Total'),
                                        React.createElement('div', {style: {fontWeight: '800', fontSize: '18px'}}, 'à§³' + (bookingModal.totalAmount || 0).toLocaleString())
                                    ),
                                    React.createElement('div', {style: {textAlign: 'center', padding: '14px', background: 'rgba(34,197,94,0.15)', borderRadius: '10px'}},
                                        React.createElement('div', {style: {fontSize: '12px', color: 'rgba(255,255,255,0.5)'}}, 'Paid'),
                                        React.createElement('div', {style: {fontWeight: '800', fontSize: '18px', color: '#22c55e'}}, 'à§³' + (bookingModal.paidAmount || 0).toLocaleString())
                                    ),
                                    React.createElement('div', {style: {textAlign: 'center', padding: '14px', background: 'rgba(239,68,68,0.15)', borderRadius: '10px'}},
                                        React.createElement('div', {style: {fontSize: '12px', color: 'rgba(255,255,255,0.5)'}}, 'Due'),
                                        React.createElement('div', {style: {fontWeight: '800', fontSize: '18px', color: '#ef4444'}}, 'à§³' + ((bookingModal.totalAmount || 0) - (bookingModal.paidAmount || 0)).toLocaleString())
                                    )
                                ),
                                
                                // Action Buttons
                                React.createElement('div', {style: {display: 'flex', gap: '12px'}},
                                    React.createElement('button', {className: 'btn-primary', style: {flex: 1}}, 'ðŸ’³ Add Payment'),
                                    React.createElement('button', {style: {flex: 1, padding: '14px', background: 'rgba(255,255,255,0.1)', border: 'none', borderRadius: '12px', color: '#fff', cursor: 'pointer', fontWeight: '600'}}, 'âœï¸ Edit')
                                )
                            )
                        )
                    )
                );
            };

            // Main App Return
            return React.createElement('div', null,
                // Top Bar - Fixed
                React.createElement('div', {className: 'top-bar'},
                    React.createElement('div', {style: {display: 'flex', justifyContent: 'space-between', alignItems: 'center'}},
                        React.createElement('div', null,
                            React.createElement('h1', {className: 'property-name'}, 'ðŸ¨ Miami Beach Resort'),
                            React.createElement('div', {className: 'property-time'}, 
                                "Cox's Bazar â€¢ " + currentTime,
                                React.createElement('span', {className: 'gmt-badge'}, 'GMT+6')
                            )
                        ),
                        React.createElement('div', {style: {display: 'flex', gap: '14px', alignItems: 'center'}},
                            React.createElement('button', {className: 'search-btn'}, 'ðŸ” Search Guest'),
                            React.createElement('button', {
                                className: 'refresh-btn ' + (loading ? 'loading' : ''),
                                onClick: handleRefresh
                            }, 
                                loading ? React.createElement('div', {className: 'spinner'}) : 'ðŸ”„',
                                ' Refresh'
                            )
                        )
                    )
                ),
                
                // Main Content
                React.createElement('div', {className: 'main-content'},
                    // Stats Row
                    React.createElement('div', {className: 'stats-row'},
                        React.createElement('div', {className: 'stat-card animate-fade'},
                            React.createElement('div', {className: 'stat-num'}, stats.total),
                            React.createElement('div', {className: 'stat-label'}, 'Total')
                        ),
                        React.createElement('div', {className: 'stat-card animate-fade', style: {animationDelay: '0.1s'}},
                            React.createElement('div', {className: 'stat-num', style: {color: '#22c55e'}}, stats.available),
                            React.createElement('div', {className: 'stat-label'}, 'Available')
                        ),
                        React.createElement('div', {className: 'stat-card animate-fade', style: {animationDelay: '0.2s'}},
                            React.createElement('div', {className: 'stat-num', style: {color: '#2563eb'}}, stats.occupied),
                            React.createElement('div', {className: 'stat-label'}, 'Occupied')
                        ),
                        React.createElement('div', {className: 'stat-card animate-fade', style: {animationDelay: '0.3s'}},
                            React.createElement('div', {className: 'stat-num', style: {color: '#22c55e'}}, stats.checkIn),
                            React.createElement('div', {className: 'stat-label'}, 'Check-in')
                        ),
                        React.createElement('div', {className: 'stat-card animate-fade', style: {animationDelay: '0.4s'}},
                            React.createElement('div', {className: 'stat-num', style: {color: '#f97316'}}, stats.checkOut),
                            React.createElement('div', {className: 'stat-label'}, 'Check-out')
                        )
                    ),
                    
                    // Tabs - Centered
                    React.createElement('div', {className: 'tabs-container'},
                        React.createElement('div', {className: 'tabs-row'},
                            tabs.map(tab => 
                                React.createElement('div', {key: tab.id, className: 'nav-btn-wrapper'},
                                    React.createElement('button', {
                                        className: 'nav-btn ' + (activeTab === tab.id ? 'active' : ''),
                                        onClick: () => setActiveTab(tab.id)
                                    }, tab.label),
                                    tab.hasNotification && React.createElement('span', {className: 'notification-badge'}, tab.notificationCount || '!')
                                )
                            )
                        )
                    ),
                    
                    // Content
                    renderContent()
                ),
                
                // Modal
                renderBookingModal(),
                
                // Version Tag
                React.createElement('div', {className: 'version-tag'}, 'v20')
            );
        }
        
        ReactDOM.render(React.createElement(App), document.getElementById('root'));
    </script>
</body>
</html>
